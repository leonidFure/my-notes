**DDD (Domain-Driven Design)** — это подход к проектированию сложных программных систем, который фокусируется на моделировании домена (области предметной области) и создании программного обеспечения, которое точно отражает этот домен. Идея заключается в том, чтобы глубоко понять бизнес-логику и использовать её для построения архитектуры системы. В DDD ключевое внимание уделяется тесному взаимодействию между экспертами в области (бизнес-экспертами) и разработчиками для создания общей модели, которая будет использоваться в процессе разработки.
Основные концепты DDD:
### 1. **Ubiquitous Language (Общий язык)**
Это язык, который используется всеми участниками проекта — как разработчиками, так и бизнес-экспертами. Он позволяет избежать недоразумений и ошибок в интерпретации, поскольку все термины и концепты системы чётко определены и понятны всем сторонам. Общий язык становится основой для создания модели домена.
### 2. **Bounded Context (Ограниченный контекст)**
В DDD домен разделяется на несколько "ограниченных контекстов", которые представляют собой части системы, в которых определённые термины и модели имеют одно значение. Например, в одной части системы слово "заказ" может означать одну вещь, а в другой — совершенно другую. Каждый контекст имеет свои собственные модели данных и логику, но они могут взаимодействовать через заранее определённые механизмы, такие как API, события или сообщения.
### 3. **Entities (Сущности)**
Это объекты, которые имеют уникальный идентификатор и могут изменяться во времени. Например, заказ может быть сущностью, поскольку он имеет уникальный идентификатор (номер заказа) и может менять своё состояние (статус, товары и т. д.).
### 4. **Value Objects (Объекты-значения)**
Это объекты, которые не имеют уникального идентификатора и их основное назначение — это хранение данных. Например, адрес может быть объектом-значением, потому что его можно заменить другим адресом, и он не будет иметь значения в контексте всей системы.
### 5. **Aggregates (Агрегаты)**
Агрегат — это группа связанных сущностей и объектов-значений, которые должны рассматриваться как единое целое при изменении данных. Он гарантирует, что все изменения внутри агрегата будут корректны с точки зрения бизнес-правил. Агрегат имеет "root" (корень) — сущность, через которую происходит доступ ко всем данным агрегата.
### 6. **Repositories (Репозитории)**
Репозитории обеспечивают доступ к агрегатам, скрывая детали хранения данных. Они представляют собой интерфейсы, через которые можно извлекать и сохранять агрегаты, обеспечивая таким образом инкапсуляцию слоя данных.
### 7. **Services (Сервисы)**
Сервисы в DDD — это объекты, которые предоставляют бизнес-логику, которая не привязана к одной сущности или агрегату. Это операции, которые имеют смысл для всей системы, но не принадлежат конкретному объекту. Например, сервис для обработки заказов.
### 8. **Factories (Фабрики)**
Фабрики создают объекты, такие как агрегаты или сущности. Они скрывают сложную логику создания объектов и предоставляют простой интерфейс для создания сложных объектов с правильно настроенными зависимостями и состоянием.
### 9. **Domain Events (События домена)**
События домена — это важные события, которые произошли в системе и имеют значение для бизнеса. Они могут быть использованы для коммуникации между различными частями системы или другими системами. Например, "Заказ создан" или "Товар отправлен".
### 10. **Anti-Corruption Layer (Слой защиты от загрязнения)**
Это слой, который защищает ваш домен от внешних систем или контекстов, которые могут использовать другую модель или другую терминологию. Он служит промежуточным слоем, который преобразует данные и логику внешней системы в формат, понятный вашему домену.
### 11. **Context Mapping (Картография контекстов)**
В DDD важно понимать, как различные ограниченные контексты взаимодействуют друг с другом. Контекстная карта помогает визуализировать зависимости между контекстами, чтобы избежать конфликтов и обеспечить корректную интеграцию. Взаимодействие между контекстами может быть разных типов, например, через события или API.
### Преимущества DDD:
- **Глубокое понимание бизнеса**: DDD требует постоянного взаимодействия с бизнес-экспертами, что помогает создавать решения, которые действительно решают проблемы бизнеса.
- **Единая модель для всей системы**: Общий язык и ограниченные контексты позволяют избежать недоразумений и упрощают поддержку системы.
- **Гибкость и масштабируемость**: DDD позволяет строить систему с возможностью её эволюции, легко добавлять новые доменные концепты и адаптировать систему под изменения.
### Когда стоит применять DDD:
- Когда бизнес-логика сложна и требует глубокого понимания.
- Когда нужно работать с большими, распределёнными или сложными системами.
- Когда важна высокая степень согласованности данных и точности бизнес-операций.